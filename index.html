<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Işık Kontrolü</title>
  <script type="module">
    // Firebase SDK'larını içe aktarın
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js";

    // Firebase yapılandırması
    const firebaseConfig = {
      apiKey: "AIzaSyDLyuomuSnuom0NQVMZtRet55MHqZMdB6Y",
      authDomain: "isik-kontrol-7e804.firebaseapp.com",
      databaseURL: "https://isik-kontrol-7e804-default-rtdb.firebaseio.com",
      projectId: "isik-kontrol-7e804",
      storageBucket: "isik-kontrol-7e804.appspot.com",
      messagingSenderId: "1007306433265",
      appId: "1:1007306433265:web:e31012263b90874da0ff50",
      measurementId: "G-RKR3WT430H"
    };

    // Firebase'i başlatın
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Veri referansı
    const lightRef = ref(database, 'lightStatus');

    // Butonun durumunu güncelleme işlevi
    const updateLightStatus = (status) => {
      set(lightRef, status)
        .then(() => {
          console.log(`Light turned ${status ? 'on' : 'off'}`);
        })
        .catch((error) => {
          console.error("Error updating light status:", error);
        });
    };

    // Butona tıklama işlevi
    const toggleLight = () => {
      onValue(lightRef, (snapshot) => {
        const currentStatus = snapshot.val();
        updateLightStatus(!currentStatus);
      });
    };

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('toggleButton').addEventListener('click', toggleLight);

      // Başlangıçta ışığın durumunu al
      onValue(lightRef, (snapshot) => {
        const status = snapshot.val();
        document.getElementById('status').textContent = status ? 'Işık Açık' : 'Işık Kapalı';
      });
    });
  </script>
</head>
<body>
  <h1>Işık Kontrolü</h1>
  <p>Durum: <span id="status">Yükleniyor...</span></p>
  <button id="toggleButton">Işığı Aç/Kapa</button>
</body>
</html>
